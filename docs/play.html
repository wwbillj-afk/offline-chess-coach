<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">

<title>Offline Chess Coach</title>

<!-- Chessboard.js -->
<link rel="stylesheet" href="https://unpkg.com/chessboardjs@1.0.0/dist/chessboard-1.0.0.min.css">

<style>
body{
  margin:0;
  font-family:system-ui,-apple-system,BlinkMacSystemFont,sans-serif;
  background:linear-gradient(180deg,#081624,#020a14);
  color:#fff;
}

.container{
  max-width:420px;
  margin:0 auto;
  padding:16px;
}

h1{
  text-align:center;
  margin:12px 0 16px;
  font-weight:700;
}

.coach-box{
  display:flex;
  gap:12px;
  background:rgba(255,255,255,0.06);
  padding:12px;
  border-radius:14px;
  align-items:center;
}

.coach-box img{
  width:64px;
  height:64px;
  border-radius:50%;
  object-fit:cover;
  border:2px solid #6bd36b;
}

.coach-text{
  font-size:14px;
  line-height:1.3;
}

.label{
  margin-top:16px;
  font-size:14px;
  opacity:0.9;
}

input[type=range]{
  width:100%;
}

.controls{
  display:flex;
  gap:10px;
  margin-top:14px;
  align-items:center;
}

button{
  border:none;
  border-radius:24px;
  padding:12px 18px;
  font-size:14px;
  cursor:pointer;
}

.start{
  background:#6bd36b;
  color:#000;
  font-weight:600;
}

.hint{
  background:#2a3340;
  color:#fff;
}

#board{
  width:100%;
  height:360px; /* MOBILE SAFE */
  margin-top:18px;
  border-radius:14px;
  box-shadow:0 20px 40px rgba(0,0,0,0.6);
}
</style>
</head>

<body>
<div class="container">

<h1>Offline Chess Coach</h1>

<div class="coach-box">
  <img src="/offline-chess-coach/docs/file_0000000db887f6dde52fee7800f79.png" alt="Coach">
  <div class="coach-text" id="coachText">
    Welcome. Pick a level and press <b>Start game</b>.
  </div>
</div>

<div class="label">Difficulty — <span id="levelText">5</span></div>
<input type="range" min="1" max="10" value="5" id="level">

<div class="controls">
  <button class="start" id="startBtn">Start game</button>
  <button class="hint" id="hintBtn">Hint</button>
</div>

<div id="board"></div>

</div>

<!-- Scripts -->
<script src="https://unpkg.com/chess.js@1.0.0/chess.min.js"></script>
<script src="https://unpkg.com/chessboardjs@1.0.0/dist/chessboard-1.0.0.min.js"></script>

<script>
let game = new Chess();
let board = null;
let started = false;

const coachText = document.getElementById("coachText");
const levelSlider = document.getElementById("level");
const levelText = document.getElementById("levelText");

levelSlider.oninput = () => {
  levelText.textContent = levelSlider.value;
};

function onDragStart (source, piece) {
  if (!started) return false;
  if (game.game_over()) return false;
  if (piece.startsWith('b')) return false;
}

function onDrop (source, target) {
  let move = game.move({
    from: source,
    to: target,
    promotion: 'q'
  });

  if (move === null) return 'snapback';

  coachText.innerHTML = "Good. Let me think…";

  setTimeout(makeCoachMove, 400);
}

function makeCoachMove(){
  if (game.game_over()) return;

  let moves = game.moves();
  if (moves.length === 0) return;

  let move = moves[Math.floor(Math.random() * moves.length)];
  game.move(move);
  board.position(game.fen());

  coachText.innerHTML = "Your turn.";
}

function startGame(){
  game.reset();
  started = true;

  if (!board){
    board = Chessboard('board',{
      draggable:true,
      position:'start',
      onDragStart:onDragStart,
      onDrop:onDrop
    });
    setTimeout(()=>board.resize(),100);
  } else {
    board.position('start');
  }

  coachText.innerHTML = "Game started. You play White.";
}

document.getElementById("startBtn").onclick = startGame;

document.getElementById("hintBtn").onclick = () => {
  if (!started){
    coachText.innerHTML = "Start a game first.";
    return;
  }
  let moves = game.moves({ verbose:true });
  if (moves.length){
    coachText.innerHTML = "Consider: <b>" + moves[0].from + " → " + moves[0].to + "</b>";
  }
};
</script>

</body>
  </html>
