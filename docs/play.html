<script>
  const game = new Chess();

  const board = Chessboard('board', {
    position: 'start',
    draggable: true,
    pieceTheme: 'https://chessboardjs.com/img/chesspieces/cburnett/{piece}.png',

    onDragStart: function (source, piece) {
      // prevent moving black pieces
      if (piece.startsWith('b')) return false;
    },

    onDrop: function (source, target) {
      const move = game.move({
        from: source,
        to: target,
        promotion: 'q'
      });

      if (move === null) return 'snapback';

      document.querySelector('.coach').innerText = 'Coach: Move played.';
    }
  });

  // MOBILE TAP SUPPORT
  let selectedSquare = null;

  board.onSquareClick = function (square) {
    if (!selectedSquare) {
      selectedSquare = square;
    } else {
      const move = game.move({
        from: selectedSquare,
        to: square,
        promotion: 'q'
      });

      selectedSquare = null;

      if (move) {
        board.position(game.fen());
      }
    }
  };
    </script>
